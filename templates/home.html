{% extends "base.html" %}
{% block title %}Dashboard - Art Moving Business{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <!-- Work Orders Card -->
  <div class="col-md-3">
    <div class="card text-white bg-info mb-3">
      <div class="card-header">Work Orders</div>
      <div class="card-body">
        <h5 class="card-title">View All</h5>
        <p class="card-text">Manage work orders and track job progress.</p>
        <a href="{% url 'workorder_list' %}" class="btn btn-light">Go to Work Orders</a>
      </div>
    </div>
  </div>
  <!-- Clients Card -->
  <div class="col-md-3">
    <div class="card text-white bg-warning mb-3">
      <div class="card-header">Clients</div>
      <div class="card-body">
        <h5 class="card-title">View Clients</h5>
        <p class="card-text">Client database and details.</p>
        <a href="{% url 'client_list' %}" class="btn btn-light">Go to Clients</a>
      </div>
    </div>
  </div>
  <!-- Invoicing Card -->
  <div class="col-md-3">
    <div class="card text-white bg-danger mb-3">
      <div class="card-header">Invoicing</div>
      <div class="card-body">
        <h5 class="card-title">Manage Invoices</h5>
        <p class="card-text">Generate and review invoices.</p>
        <a href="{% url 'invoice_list' %}" class="btn btn-light">Go to Invoicing</a>
      </div>
    </div>
  </div>
</div>

<!-- Calendar Section -->
<div class="card mt-4">
  <div class="card-header">
    Calendar
  </div>
  <div class="card-body">
    <div id="calendar"></div>
  </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function () {
    var calendarEl = document.getElementById("calendar");
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: "dayGridMonth",
        events: async function(fetchInfo, successCallback, failureCallback) {
            try {
                let workorders = await fetch("/calendar-data/workorders/").then(res => res.json());
                let invoices = await fetch("/calendar-data/invoices/").then(res => res.json());
                successCallback([...workorders, ...invoices]);
            } catch (error) {
                failureCallback(error);
            }
        },
        eventClick: function(info) {
            window.location.href = info.event.url;
            info.jsEvent.preventDefault();
        }
    });
    calendar.render();
});
</script>
{% endblock %}
