{% if jobs %}
  <!-- Desktop Table View -->
  <div class="d-none d-md-block">
    <div class="table-responsive">
      <table class="table table-sm table-striped align-middle mb-0">
        <thead class="small">
          <tr>
            <th>ID</th>
            <th>Client</th>
            <th class="d-none d-lg-table-cell">Description</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for job in jobs %}
          <tr>
            <td>{{ job.id }}</td>
            <td>{{ job.client.name }}</td>
            <td class="d-none d-lg-table-cell text-truncate" style="max-width:200px;">
              {{ job.job_description|truncatewords:8 }}
            </td>
            <td>
              <div class="d-flex flex-wrap gap-1">
                <a href="{% url 'workorder_detail' job.id %}" class="btn btn-sm btn-info">View</a>
                
                {% if section == 'pending' %}
                  <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning">Schedule</a>
                  <form method="post" action="{% url 'mark_completed' job.id %}" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-success">Complete</button>
                  </form>
                
                {% elif section == 'scheduled' %}
                  <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning">Edit</a>
                  <form method="post" action="{% url 'mark_completed' job.id %}" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-success">Complete</button>
                  </form>
                
                {% elif section == 'completed' %}
                  <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning">Edit</a>
                  <a href="/invoices/create/?work_order={{ job.id }}" class="btn btn-sm btn-success">Invoice</a>
                
                {% elif section == 'invoiced' %}
                  <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning">Edit</a>
                  {% if job.invoices.exists %}
                    <a href="{% url 'invoice_detail' job.invoices.first.id %}" class="btn btn-sm btn-outline-success">Invoice</a>
                  {% endif %}
                {% endif %}
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  
  <!-- Mobile Card View -->
  <div class="d-md-none">
    {% for job in jobs %}
    <div class="border-bottom p-3">
      <div class="d-flex justify-content-between align-items-start mb-2">
        <div class="flex-grow-1">
          <div class="fw-bold">Work Order #{{ job.id }}</div>
          <div class="text-muted small">{{ job.client.name }}</div>
          <div class="text-muted small">{{ job.job_description|truncatewords:6 }}</div>
        </div>
        <span class="badge 
          {% if job.status == 'pending' %}bg-secondary
          {% elif job.status == 'in_progress' %}bg-info
          {% else %}bg-success{% endif %} ms-2">
          {{ job.get_status_display }}
        </span>
      </div>
      
      <div class="d-flex flex-wrap gap-1">
        <a href="{% url 'workorder_detail' job.id %}" class="btn btn-sm btn-info flex-fill">View</a>
        
        {% if section == 'pending' %}
          <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning flex-fill">Schedule</a>
          <form method="post" action="{% url 'mark_completed' job.id %}" class="flex-fill">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-success w-100">Complete</button>
          </form>
        
        {% elif section == 'scheduled' %}
          <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning flex-fill">Edit</a>
          <form method="post" action="{% url 'mark_completed' job.id %}" class="flex-fill">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-success w-100">Complete</button>
          </form>
        
        {% elif section == 'completed' %}
          <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning flex-fill">Edit</a>
          <a href="/invoices/create/?work_order={{ job.id }}" class="btn btn-sm btn-success flex-fill">Invoice</a>
        
        {% elif section == 'invoiced' %}
          <a href="{% url 'workorder_edit' job.id %}" class="btn btn-sm btn-warning flex-fill">Edit</a>
          {% if job.invoices.exists %}
            <a href="{% url 'invoice_detail' job.invoices.first.id %}" class="btn btn-sm btn-outline-success flex-fill">Invoice</a>
          {% endif %}
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
{% else %}
  <div class="p-4 text-center text-muted">
    <i class="bi bi-inbox fs-1 mb-2 d-block"></i>
    No jobs found.
  </div>
{% endif %}